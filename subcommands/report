#!/usr/bin/env bash
set -eo pipefail
[[ $DOKKU_TRACE ]] && set -x

source "$PLUGIN_AVAILABLE_PATH/tailscale/functions"

cmd-tailscale-report() {
  declare cmd="tailscale:report"
  [[ "$1" == "$cmd" ]] && shift 1

    if [[ "$1" == "--service" ]]; then
      shift 1; parse_service_flag "$1"
    else
      # Only set APP if a value was supplied; otherwise aggregate mode
      if [[ -n "$1" ]]; then
        export APP="$1"
      fi
    fi

  tailscale_report
}

cmd-tailscale-report "$@"